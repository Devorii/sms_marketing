{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/Users/devorii/Desktop/sms_beta/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from\"react\";import Footer from\"../components/Footer\";import Cookies from\"js-cookie\";import CreateMsgbutton from\"../components/Createmsgbutton\";import DeleteMessageComponent from\"../components/DeleteMessageComponent\";import UpdateMessages from\"../components/UpdateMessages\";import{ContactContext}from\"../context/ContactsCtxt\";import Delete from\"../assets/messageIcons/delete.svg\";import Update from\"../assets/messageIcons/update.svg\";import Send from\"../assets/messageIcons/send.svg\";var Message=function Message(props){var _useContext=useContext(ContactContext),contacts=_useContext.contacts;var _useState=useState({items:null,loaded:false}),_useState2=_slicedToArray(_useState,2),messageItem=_useState2[0],setMessageItem=_useState2[1];var _useState3=useState({width:\"100%\",display:\"flex\",justifyContent:\"center\"}),_useState4=_slicedToArray(_useState3,2),updateStyle=_useState4[0],setUpdateStyle=_useState4[1];var _useState5=useState({width:\"100%\",display:\"none\",justifyContent:\"center\"}),_useState6=_slicedToArray(_useState5,2),updateStyleNone=_useState6[0],setUpdateStyleNone=_useState6[1];var _useState7=useState({id:0,loaded:false}),_useState8=_slicedToArray(_useState7,2),selectID=_useState8[0],setSelectID=_useState8[1];var _useState9=useState({id:\"\",title:\"\",message:\"\",url:\"\",loaded:false}),_useState10=_slicedToArray(_useState9,2),message=_useState10[0],setMessage=_useState10[1];var _useState11=useState('closeDelete'),_useState12=_slicedToArray(_useState11,2),deleteOnClick=_useState12[0],setDeleteOnClick=_useState12[1];var _useState13=useState({top:\"0\",right:\"0\",marginTop:'20px',marginRight:'20px',position:\"fixed\",backgroundColor:\"red\",width:'29px',height:'29px',border:\"none\",borderRadius:'100px',padding:\"5px\",fontSize:\"15px\",color:\"white\"}),_useState14=_slicedToArray(_useState13,2),closeBtn=_useState14[0],SetCloseBtn=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),showUpdate=_useState16[0],setShowUpdate=_useState16[1];var exOnClick=function exOnClick(){return setShowUpdate(!showUpdate);};var updateOnClick=function updateOnClick(){return setShowUpdate(true);};useEffect(function(){var storedTitle;fetch(\"http://devorii.pythonanywhere.com/onload-messages\",{method:\"GET\",mode:\"cors\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",\"Access-Control-Allow-Origin\":\"*\",\"x-access-token\":Cookies.get(\"token\")}}).then(function(resp){return resp.json();}).then(function(items){setMessageItem({items:Object.values(items),loaded:true});// Call another fetch to return an obj\nsetSelectID({id:Object.values(items)[0].id,loaded:true});storedTitle=Object.values(items)[0].title;return fetch(\"http://devorii.pythonanywhere.com/template/\".concat(Object.values(items)[0].id),{method:\"GET\",mode:\"cors\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",\"Access-Control-Allow-Origin\":\"*\",\"x-access-token\":Cookies.get(\"token\")}});}).then(function(response){return response.json();}).then(function(resp_items){setMessage({id:Object.values(resp_items)[0].id,title:storedTitle,message:Object.values(resp_items)[0].Message,url:Object.values(resp_items)[0].url,loaded:true});});},[]);// SELECTED TEMPLATES\nvar selectedTemplate=function selectedTemplate(e){var index=e.target.selectedIndex;var selection_id=e.target.value;setSelectID({id:selection_id,loaded:true});fetch(\"http://devorii.pythonanywhere.com/template/\".concat(selection_id),{method:\"GET\",mode:\"cors\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",\"Access-Control-Allow-Origin\":\"*\",\"x-access-token\":Cookies.get(\"token\")}}).then(function(response){return response.json();}).then(function(resp_items){setMessage({id:Object.values(resp_items)[0].id,title:e.target[index].text,message:Object.values(resp_items)[0].Message,url:Object.values(resp_items)[0].url,loaded:true});});};// Deleting selection\nvar deleteSelected=function deleteSelected(){setDeleteOnClick('openDelete');};var updateParentState=function updateParentState(childProps){setDeleteOnClick(childProps);};//Sending messages\nvar sendingmessages=function sendingmessages(){var send_contacts=[];var send_names=[];var send_msg=message.message;var send_img=\"http://devorii.pythonanywhere.com/images/\".concat(selectID.id);var send_temp_name=message.title;var send_temp_id=message.id;var send_url=message.url;var listOfContacts=contacts[0].contacts.items;listOfContacts.map(function(obj){send_contacts.push(obj.number);send_names.push(obj.name);});console.log(send_contacts);fetch(\"http://devorii.pythonanywhere.com/send-messages\",{method:'POST',mode:'cors',body:JSON.stringify({api_numbers:send_contacts,api_names:send_names,api_msg:send_msg,api_url:send_url,api_img:send_img,api_title:send_temp_name,api_id:send_temp_id}),headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",\"Access-Control-Allow-Origin\":\"*\",\"x-access-token\":Cookies.get(\"token\")}});};//  Render load conditions\nvar loaded=messageItem.loaded;if(!loaded){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});}else{return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"app-bg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"pagetitle pageDesc\",children:/*#__PURE__*/_jsx(\"b\",{children:\"Template\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"page_greeting messageIconsParentContainer\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"pageDesc\",children:\"View Templates\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{style:{width:'18px',height:'18px',marginLeft:'40px',marginTop:'10px'},onClick:deleteSelected,src:Delete,alt:\"\"}),/*#__PURE__*/_jsx(\"img\",{style:{width:'18px',height:'18px',marginLeft:'10px',marginTop:'10px'},onClick:updateOnClick,src:Update,alt:\"\"}),/*#__PURE__*/_jsx(\"img\",{style:{width:'18px',height:'18px',marginLeft:'10px',marginTop:'10px'},onClick:sendingmessages,src:Send,alt:\"\"})]})]}),/*#__PURE__*/_jsx(\"select\",{id:\"selectId\",onChange:selectedTemplate,children:messageItem.items.map(function(obj){return/*#__PURE__*/_jsx(\"option\",{style:{color:\"#6B6B6B\",display:\"flex\",flexDirection:\"column\"},name:obj.title,value:obj.id,children:obj.title},obj.id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"cardHolder\",children:/*#__PURE__*/_jsx(\"div\",{className:\"message_card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"image_holder\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"displayImg\",src:selectID.loaded?\"http://devorii.pythonanywhere.com/images/\".concat(selectID.id):\"http://devorii.pythonanywhere.com/images/4\",alt:\"content_image\"}),/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"left\",paddingLeft:\"20px\",paddingRight:\"20px\",marginBottom:\"2px\"},children:message.loaded?message.message:\"No message found\"}),/*#__PURE__*/_jsx(\"p\",{style:{textAlign:\"left\",paddingLeft:\"20px\",paddingRight:\"20px\",color:\"blue\",textDecoration:\"underline\",marginTop:\"1px\"},children:message.loaded?message.url:\"No url found\"})]})})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(DeleteMessageComponent,{selected:selectID.id,cond:deleteOnClick,onNameChange:updateParentState})}),/*#__PURE__*/_jsxs(\"div\",{style:showUpdate?updateStyle:updateStyleNone,children:[/*#__PURE__*/_jsx(\"button\",{onClick:exOnClick,style:closeBtn,children:\"X\"}),/*#__PURE__*/_jsx(UpdateMessages,{id:selectID.id,title:message.title,message:message.message,url:message.url})]}),/*#__PURE__*/_jsx(\"div\",{className:\"msgBtn\",children:/*#__PURE__*/_jsx(CreateMsgbutton,{})}),/*#__PURE__*/_jsx(Footer,{})]})});}};export default Message;","map":{"version":3,"sources":["/Users/devorii/Desktop/sms_beta/src/pages/Message.js"],"names":["React","useEffect","useState","useContext","Footer","Cookies","CreateMsgbutton","DeleteMessageComponent","UpdateMessages","ContactContext","Message","props","contacts","items","loaded","messageItem","setMessageItem","width","display","justifyContent","updateStyle","setUpdateStyle","updateStyleNone","setUpdateStyleNone","id","selectID","setSelectID","title","message","url","setMessage","deleteOnClick","setDeleteOnClick","top","right","marginTop","marginRight","position","backgroundColor","height","border","borderRadius","padding","fontSize","color","closeBtn","SetCloseBtn","showUpdate","setShowUpdate","exOnClick","updateOnClick","storedTitle","fetch","method","mode","headers","get","then","resp","json","Object","values","response","resp_items","selectedTemplate","e","index","target","selectedIndex","selection_id","value","text","deleteSelected","updateParentState","childProps","sendingmessages","send_contacts","send_names","send_msg","send_img","send_temp_name","send_temp_id","send_url","listOfContacts","map","obj","push","number","name","console","log","body","JSON","stringify","api_numbers","api_names","api_msg","api_url","api_img","api_title","api_id","marginLeft","Delete","Update","Send","flexDirection","textAlign","paddingLeft","paddingRight","marginBottom","textDecoration"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport Footer from \"../components/Footer\";\nimport Cookies from \"js-cookie\";\nimport CreateMsgbutton from \"../components/Createmsgbutton\";\nimport DeleteMessageComponent from \"../components/DeleteMessageComponent\";\nimport UpdateMessages from \"../components/UpdateMessages\";\nimport { ContactContext } from \"../context/ContactsCtxt\"\nimport Delete from '../assets/messageIcons/delete.svg'\nimport Update from '../assets/messageIcons/update.svg'\nimport Send from '../assets/messageIcons/send.svg'\n\n\nconst Message = (props) => {\n\tconst {contacts} = useContext(ContactContext)\n\n\n\tconst [messageItem, setMessageItem] = useState({\n\t\titems: null,\n\t\tloaded: false,\n\t});\n\tconst [updateStyle, setUpdateStyle] = useState({\n\t\twidth: \"100%\",\n\t\tdisplay: \"flex\",\n\t\tjustifyContent: \"center\",\n\t});\n\tconst [updateStyleNone, setUpdateStyleNone] = useState({\n\t\twidth: \"100%\",\n\t\tdisplay: \"none\",\n\t\tjustifyContent: \"center\",\n\t});\n\tconst [selectID, setSelectID] = useState({\n\t\tid: 0,\n\t\tloaded: false,\n\t});\n\tconst [message, setMessage] = useState({\n\t\tid: \"\",\n\t\ttitle: \"\",\n\t\tmessage: \"\",\n\t\turl: \"\",\n\t\tloaded: false,\n\t});\n\tconst [deleteOnClick, setDeleteOnClick] = useState('closeDelete');\n\n\tconst [closeBtn, SetCloseBtn] = useState({\n\t\ttop: \"0\",\n\t\tright: \"0\",\n\t\tmarginTop: '20px',\n\t\tmarginRight: '20px',\n\t\tposition: \"fixed\",\n\t\tbackgroundColor: \"red\",\n\t\twidth: '29px',\n\t\theight: '29px',\n\t\tborder: \"none\",\n\t\tborderRadius: '100px',\n\t\tpadding: \"5px\",\n\t\tfontSize: \"15px\",\n\t\tcolor: \"white\",\n\t});\n\tconst [showUpdate, setShowUpdate] = useState(false);\n\n\tconst exOnClick = () => setShowUpdate(!showUpdate);\n\tconst updateOnClick = () => setShowUpdate(true);\n\n\tuseEffect(() => {\n\t\tvar storedTitle;\n\n\t\tfetch(\"http://devorii.pythonanywhere.com/onload-messages\", {\n\t\t\tmethod: \"GET\",\n\t\t\tmode: \"cors\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\",\n\t\t\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\t\t\"x-access-token\": Cookies.get(\"token\"),\n\t\t\t},\n\t\t})\n\t\t\t.then((resp) => resp.json())\n\t\t\t.then((items) => {\n\t\t\t\tsetMessageItem({ items: Object.values(items), loaded: true });\n\t\t\t\t// Call another fetch to return an obj\n\t\t\t\tsetSelectID({ id: Object.values(items)[0].id, loaded: true });\n\t\t\t\tstoredTitle = Object.values(items)[0].title;\n\n\t\t\t\treturn fetch(\n\t\t\t\t\t`http://devorii.pythonanywhere.com/template/${Object.values(items)[0].id}`,\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\t\tmode: \"cors\",\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\",\n\t\t\t\t\t\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\t\t\t\t\t\"x-access-token\": Cookies.get(\"token\"),\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t})\n\t\t\t.then((response) => response.json())\n\t\t\t.then((resp_items) => {\n\t\t\t\tsetMessage({\n\t\t\t\t\tid: Object.values(resp_items)[0].id,\n\t\t\t\t\ttitle: storedTitle,\n\t\t\t\t\tmessage: Object.values(resp_items)[0].Message,\n\t\t\t\t\turl: Object.values(resp_items)[0].url,\n\t\t\t\t\tloaded: true,\n\t\t\t\t});\n\t\t\t});\n\t}, []);\n\n\t// SELECTED TEMPLATES\n\tconst selectedTemplate = (e) => {\n\t\tvar index = e.target.selectedIndex;\n\t\tconst selection_id = e.target.value;\n\n\t\tsetSelectID({ id: selection_id, loaded: true });\n\n\t\tfetch(`http://devorii.pythonanywhere.com/template/${selection_id}`, {\n\t\t\tmethod: \"GET\",\n\t\t\tmode: \"cors\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\",\n\t\t\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\t\t\"x-access-token\": Cookies.get(\"token\"),\n\t\t\t},\n\t\t})\n\t\t\t.then((response) => response.json())\n\t\t\t.then((resp_items) => {\n\t\t\t\tsetMessage({\n\t\t\t\t\tid: Object.values(resp_items)[0].id,\n\t\t\t\t\ttitle: e.target[index].text,\n\t\t\t\t\tmessage: Object.values(resp_items)[0].Message,\n\t\t\t\t\turl: Object.values(resp_items)[0].url,\n\t\t\t\t\tloaded: true,\n\t\t\t\t});\n\t\t\t});\n\t};\n\n\t// Deleting selection\n\tconst deleteSelected = () => {\n\t\tsetDeleteOnClick('openDelete')\n\t};\nconst updateParentState = (childProps) =>{\nsetDeleteOnClick(childProps)\n}\n\t//Sending messages\n\tconst sendingmessages = () => {\n\t\tconst send_contacts = []\n\t\tconst send_names = []\n\t\tconst send_msg = message.message\n\t\tconst send_img = `http://devorii.pythonanywhere.com/images/${selectID.id}`\n\t\tconst send_temp_name = message.title\n\t\tconst send_temp_id = message.id\n\n\t\tconst send_url = message.url\n\n\t\tconst listOfContacts = contacts[0].contacts.items\n\t\tlistOfContacts.map((obj)=>{\n\t\t\tsend_contacts.push(obj.number)\n\t\t\tsend_names.push(obj.name)\n\t\t})\n\n\t\tconsole.log(send_contacts)\n\t\tfetch(`http://devorii.pythonanywhere.com/send-messages`, {\n\t\t\tmethod: 'POST',\n\t\t\tmode: 'cors',\n\t\t\tbody: JSON.stringify({\n\t\t\t\tapi_numbers: send_contacts,\n\t\t\t\tapi_names: send_names,\n\t\t\t\tapi_msg: send_msg,\n\t\t\t\tapi_url: send_url,\n\t\t\t\tapi_img: send_img,\n\t\t\t\tapi_title: send_temp_name,\n\t\t\t\tapi_id: send_temp_id\n\n\t\t\t}),\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/x-www-form-urlencoded\",\n\t\t\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\t\t\"x-access-token\": Cookies.get(\"token\"),\n\t\t\t}\n\n\n\t\t})\n\t}\n\t//  Render load conditions\n\tvar { loaded } = messageItem;\n\n\tif (!loaded) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<p>Loading...</p>\n\t\t\t</>\n\t\t);\n\t} else {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className='app-bg'>\n\n\t\t\t\t<h4 className='pagetitle pageDesc'><b>Template</b></h4>\n\n\t\t\t<div className='page_greeting messageIconsParentContainer'>\n\t\t\t<h2 className='pageDesc'>View Templates</h2>\n\t\t\t<div>\n\t\t\t\t<img style={{width: '18px', height: '18px', marginLeft: '40px', marginTop: '10px'}} onClick={deleteSelected} src={Delete} alt=''></img>\n\t\t\t\t<img style={{width: '18px', height: '18px', marginLeft: '10px', marginTop: '10px'}} onClick={updateOnClick} src={Update} alt=''></img>\n\t\t\t\t<img style={{width: '18px', height: '18px', marginLeft: '10px', marginTop: '10px'}} onClick={sendingmessages} src={Send} alt=''></img>\n\n\t\t\t</div>\n\n\t\t\t</div>\n\t\t\t<select id='selectId' onChange={selectedTemplate}>\n\t\t\t\t\t\t{messageItem.items.map((obj) => (\n\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tcolor: \"#6B6B6B\",\n\t\t\t\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\t\t\t\tflexDirection: \"column\",\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tkey={obj.id}\n\t\t\t\t\t\t\t\tname={obj.title}\n\t\t\t\t\t\t\t\tvalue={obj.id}>\n\t\t\t\t\t\t\t\t{obj.title}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</select>\n\n\t\t\t\t\t<div className='cardHolder'>\n\t\t\t\t\t\t<div className='message_card'>\n\t\t\t\t\t\t\t<div className='image_holder'>\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tclassName='displayImg'\n\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\tselectID.loaded\n\t\t\t\t\t\t\t\t\t\t\t? `http://devorii.pythonanywhere.com/images/${selectID.id}`\n\t\t\t\t\t\t\t\t\t\t\t: `http://devorii.pythonanywhere.com/images/4`\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\talt='content_image'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\ttextAlign: \"left\",\n\t\t\t\t\t\t\t\t\t\tpaddingLeft: \"20px\",\n\t\t\t\t\t\t\t\t\t\tpaddingRight: \"20px\",\n\t\t\t\t\t\t\t\t\t\tmarginBottom: \"2px\",\n\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t{message.loaded ? message.message : \"No message found\"}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\ttextAlign: \"left\",\n\t\t\t\t\t\t\t\t\t\tpaddingLeft: \"20px\",\n\t\t\t\t\t\t\t\t\t\tpaddingRight: \"20px\",\n\t\t\t\t\t\t\t\t\t\tcolor: \"blue\",\n\t\t\t\t\t\t\t\t\t\ttextDecoration: \"underline\",\n\t\t\t\t\t\t\t\t\t\tmarginTop: \"1px\",\n\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t{message.loaded ? message.url : \"No url found\"}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t{/* Delete message component */}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<DeleteMessageComponent\n\t\t\t\t\t\t\tselected={selectID.id}\n\t\t\t\t\t\t\tcond={deleteOnClick}\n\t\t\t\t\t\t\tonNameChange = {updateParentState}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style={showUpdate ? updateStyle : updateStyleNone}>\n\t\t\t\t\t\t<button onClick={exOnClick} style={closeBtn}>\n\t\t\t\t\t\t\tX\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<UpdateMessages\n\t\t\t\t\t\t\tid={selectID.id}\n\t\t\t\t\t\t\ttitle={message.title}\n\t\t\t\t\t\t\tmessage={message.message}\n\t\t\t\t\t\t\turl={message.url}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className='msgBtn'>\n\t\t\t\t\t\t<CreateMsgbutton />\n\t\t\t\t\t</div>\n\t\t\t\t\t<Footer />\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n};\n\nexport default Message;\n"]},"metadata":{},"sourceType":"module"}